name: 'SrgCounterServiceGaction'
description: "Calls an API to retrieve a key's counter value"
inputs:
  keyName:
    description: 'Counter Key Name'
    required: true
  isNinjaApiService:
    description: 'is Ninja Api Service'
    required: false
    default: 'true'
  apiKey:
    description: 'API key for authentication'
    required: true
  apiDomain:
    description: 'API domain'
    required: false
outputs:
  gaction_output_counter_value:
    description: "The counter value from the API response"
    value: ${{ steps.step_call_api.outputs.step_output_counter_value }}
runs:
  using: "composite"
  steps:
    - name: "echo basic inputs for debug"
      shell: bash
      run: |
        echo "inputs.keyName: ${{ inputs.keyName }}"
        echo "inputs.apiDomain: ${{ inputs.apiDomain }}"
    - id: step_call_api
      shell: bash
      env:
        isForNinjaApiService: ${{ inputs.isNinjaApiService }}
      run: |
        if [ "$isForNinjaApiService" = "true" ]; then
          echo "isForNinjaApiService ----> $isForNinjaApiService"
          cout_api_result=$(bash ${{ github.action_path }}/run_counter_api_ninja "${{ inputs.keyName }}" "${{ inputs.apiKey }}")
          echo "step_output_counter_value=${cout_api_result}" >> $GITHUB_OUTPUT
        else
          echo "isForNinjaApiService ----> $isForNinjaApiService"
          cout_api_result=$(bash ${{ github.action_path }}/run_counter_api_host_service "${{ inputs.keyName }}" "${{ inputs.apiKey }}" "${{ inputs.apiDomain }}")
          echo "step_output_counter_value=${cout_api_result}" >> $GITHUB_OUTPUT
        fi

